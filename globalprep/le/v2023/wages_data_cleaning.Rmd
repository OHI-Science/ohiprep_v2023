---
title: "wages data cleaning"
output: html_document
date: "2023-08-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**From the OHI methods:**

We used the Occupational Wages around the World (OWW) database produced by Remco H. Oostendorp and Richard B. Freeman in 2005 (<http://www.nber.org/oww/>). These data were drawn from the International Labour Organization and subjected to a standardization process (for more information, see [http://www.nber.org/oww/Technical \_document_1983-2003_standardizationv3.pdf](http://www.nber.org/oww/Technical%20_document_1983-2003_standardizationv3.pdf)).

-   "The database provides several different calibrations, and we use the "x3wl calibration", described as a "country-specific and uniform calibration with lexicographic weighting," and recommended as being the preferred calibration in most cases."

-   Although significant gaps exist in this database, it contains country-specific information on average wages in many industries for more than 150 countries from 1983-2003.

-   Data represent average monthly wages of a male worker. Wage data were divided by the inflation conversion factor for 2010 so that wage data across years would be comparable (<http://oregonstate.edu/cla/polisci/sahr/sahr>), and then multiplied by the purchasing power parity-adjusted per capita gdp (ppppcgdp, WorldBank).

-   The adjusted wage data were then multiplied by 12 to get annual wages.

-   We used the industry and occupation classifications reported in the OWW to estimate wages for marine-related sectors.

**Update Notes:**

The available data from OWW now goes through 2008.

Since we have not decided what year we will be using the inflation conversion factor for, data are cleaned only to the point of selecting the appropriate sectors and occupations.

Although the methods say we used "xw3l", it appears this is a typo and the correct calibraiton is w3wl. OWW documentation says: "The standardized wage with country-specific calibration and imputation and lexicographic weighting (w3wl) is recommended for use." The variable **mw3wl_us** is selected: **monthly: country-specific calibration with imputation (lex), US\$**

From the methods we know the occupations we need:

-   Commercial fishing

    -   Industry: deep sea & coastal fishing; (y3 Industry code AE)

    -   Occupations: deep seafisher; inshore (coastal) maritime fisherman (y4 Occupation codes 9 & 10)

-   Ports & harbors

    -   Industry: supporting services to maritime transport; (y3: NE)

    -   Occupation: dock worker (y4 117)

-   Transportation and shipping

    -   Industry: maritime transport (y3 : ND)

    -   occupations: ship's chief engineer; ship's passenger stewards; able seaman ( y4: 114, 115, 116)

```{=html}
<!-- -->
```
-   Ship & boat building Industry

    -   Industry: shipbuilding and repairing; (y3: JD)

    -   Occupation: ship plater (y4: 75)

-   Tourism

    -   Industry: restaurants and hotels; (y3: MC)

    -   Occupations: hotel receptionist; cook; waiter; room attendant or chambermaid. (y4: 97, 98, 99, 100)

    -   These data are not specific to coastal/marine tourism jobs, and thus we assumed that wages in these jobs are equal in coastal and non-coastal areas

```{r}
#ilostat data
ilo_raw <- read_csv(file.path(dir_M, "/git-annex/globalprep/_raw_data/ILOSTAT/d2023/ILO_earnings_economic.csv"))


#oww
oww <- read_csv(file.path(dir_M,"/git-annex/globalprep/_raw_data/OWW/d2023/oww3.csv"))
```

Process OWW data.

```{r}
oww_clean <- oww %>% 
  filter(y4 %in% c(9, 10, 75, 97, 98, 99, 100, 114,115, 116, 117)) %>% 
  select(y0, y1, y3, y4, country_name, mw3wl_us) %>% 
  rename(country = country_name,
         year = y0, 
         industry_code = y3,
         occupation_code = y4,
         value = mw3wl_us) %>% 
  mutate(unit = "Monthly Wage USD (1)",
         sector = case_when(occupation_code %in% c(9, 10) ~ "fishing",
                            occupation_code %in% c(117) ~"ports and harbors",
                            occupation_code %in% c(114, 115, 116) ~ "transportation and shipping",
                            occupation_code == 75 ~ "ship and boat building", 
                            occupation_code %in% c(97, 98, 99, 100) ~ "tourism"),
         data_source = "oww database",
         component = "jobs") %>% 
  select(country, year, value, unit, component, occupation_code, sector)


write_csv(offshore, here(data_path, "int/all_sectors_wages.csv"))
```
